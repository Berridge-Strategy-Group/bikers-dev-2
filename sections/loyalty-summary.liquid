<div id="loy-summary" class="loy-summary" hidden>
  <span data-loy="hello">Hey, rider!</span>
  <span aria-hidden="true"> • </span>
  <strong data-loy="points">– pts</strong>
  <span data-loy="tier" class="loy-tier"></span>
</div>

<script>
(() => {
  const root = document.currentScript.previousElementSibling;
  const $ = sel => root.querySelector(sel);

  function render(data) {
    root.hidden = false;
    if (!data || !data.customer) {
      $('[data-loy="hello"]').textContent = 'Join & earn points';
      $('[data-loy="points"]').textContent = '';
      $('[data-loy="tier"]').textContent = '';
      return;
    }
    const c = data.customer;
    $('[data-loy="hello"]').textContent = 'Welcome back';
    $('[data-loy="points"]').textContent = new Intl.NumberFormat().format(c.pointBalance || 0) + ' pts';
    $('[data-loy="tier"]').textContent = c.tierId ? ` • Tier: ${c.tierId}` : '';
  }

  (window.__LOYALTY__?.subscribe(render), window.__LOYALTY__?.get().then(render).catch(()=>{}));
})();
</script>

{% schema %}
{
  "name": "Loyalty — summary",
  "settings": [],
  "presets": [{ "name": "Loyalty — summary" }]
}
{% endschema %}

